{"ast":null,"code":"const {\n  default: db\n} = require(\"./Dexie/db\");\n\nlet commandQuery = [];\n\nonmessage = e => {\n  if (e.data.op === 'add') {\n    let ws = new WebSocket(\"ws://localhost:3000\");\n\n    ws.onopen = () => {\n      console.log(\"open connection\");\n      ws.send(JSON.stringify(e.data.value));\n      commandQuery.push(e.data.value);\n      console.log(commandQuery);\n    };\n\n    ws.onmessage = async msg => {\n      console.log(\"getMessage\", msg.data);\n      let data = JSON.parse(msg.data);\n      await db.comments.add({\n        text: data.cmnt\n      }).then(() => {\n        postMessage(msg.data);\n        commandQuery.current = commandQuery.current.filter(f => f.uuid !== data.uuid);\n        ws.close();\n      }).catch(err => {\n        window.alert(err);\n      });\n    };\n  }\n};","map":{"version":3,"sources":["/Users/nirob/Desktop/rfh-chat/simplechat/src/worker.js"],"names":["default","db","require","commandQuery","onmessage","e","data","op","ws","WebSocket","onopen","console","log","send","JSON","stringify","value","push","msg","parse","comments","add","text","cmnt","then","postMessage","current","filter","f","uuid","close","catch","err","window","alert"],"mappings":"AAAA,MAAM;AAAEA,EAAAA,OAAO,EAAEC;AAAX,IAAkBC,OAAO,CAAC,YAAD,CAA/B;;AAEA,IAAIC,YAAY,GAAG,EAAnB;;AAEAC,SAAS,GAAGC,CAAC,IAAI;AACb,MAAIA,CAAC,CAACC,IAAF,CAAOC,EAAP,KAAc,KAAlB,EAAyB;AACrB,QAAIC,EAAE,GAAG,IAAIC,SAAJ,CAAc,qBAAd,CAAT;;AACAD,IAAAA,EAAE,CAACE,MAAH,GAAY,MAAM;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAJ,MAAAA,EAAE,CAACK,IAAH,CAAQC,IAAI,CAACC,SAAL,CAAeV,CAAC,CAACC,IAAF,CAAOU,KAAtB,CAAR;AACAb,MAAAA,YAAY,CAACc,IAAb,CAAkBZ,CAAC,CAACC,IAAF,CAAOU,KAAzB;AACAL,MAAAA,OAAO,CAACC,GAAR,CAAYT,YAAZ;AACH,KALD;;AAMAK,IAAAA,EAAE,CAACJ,SAAH,GAAe,MAAMc,GAAN,IAAa;AACxBP,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BM,GAAG,CAACZ,IAA9B;AACA,UAAIA,IAAI,GAAGQ,IAAI,CAACK,KAAL,CAAWD,GAAG,CAACZ,IAAf,CAAX;AACA,YAAML,EAAE,CAACmB,QAAH,CAAYC,GAAZ,CAAgB;AAClBC,QAAAA,IAAI,EAAEhB,IAAI,CAACiB;AADO,OAAhB,EAEHC,IAFG,CAEE,MAAK;AACTC,QAAAA,WAAW,CAACP,GAAG,CAACZ,IAAL,CAAX;AACAH,QAAAA,YAAY,CAACuB,OAAb,GAAuBvB,YAAY,CAACuB,OAAb,CAAqBC,MAArB,CAA4BC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWvB,IAAI,CAACuB,IAAjD,CAAvB;AACArB,QAAAA,EAAE,CAACsB,KAAH;AACH,OANK,EAMHC,KANG,CAMIC,GAAD,IAAQ;AACbC,QAAAA,MAAM,CAACC,KAAP,CAAaF,GAAb;AACH,OARK,CAAN;AASH,KAZD;AAaH;AACJ,CAvBD","sourcesContent":["const { default: db } = require(\"./Dexie/db\");\n\nlet commandQuery = [];\n\nonmessage = e => {\n    if (e.data.op === 'add') {\n        let ws = new WebSocket(\"ws://localhost:3000\");\n        ws.onopen = () => {\n            console.log(\"open connection\");\n            ws.send(JSON.stringify(e.data.value));\n            commandQuery.push(e.data.value);\n            console.log(commandQuery);\n        };\n        ws.onmessage = async msg => {\n            console.log(\"getMessage\", msg.data);\n            let data = JSON.parse(msg.data);\n            await db.comments.add({\n                text: data.cmnt\n            }).then(()=> {\n                postMessage(msg.data);\n                commandQuery.current = commandQuery.current.filter(f => f.uuid !== data.uuid)\n                ws.close();\n            }).catch((err)=> {\n                window.alert(err);\n            })\n        };\n    }\n}\n"]},"metadata":{},"sourceType":"module"}