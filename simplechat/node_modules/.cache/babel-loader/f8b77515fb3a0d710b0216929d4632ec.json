{"ast":null,"code":"const {\n  default: db\n} = require(\"./Dexie/db\");\n\nonmessage = e => {\n  if (e.data.op === 'add') {\n    let ws = new WebSocket(\"ws://localhost:3000\");\n\n    ws.onopen = () => {\n      console.log(\"open connection\");\n      ws.send(JSON.stringify(e.data.value));\n    };\n\n    ws.onmessage = msg => {\n      console.log(\"getMessage\", msg.data);\n      let data = JSON.parse(msg.data);\n      addComments(data.cmnt).then(() => {\n        postMessage(msg.data);\n      }).catch(err);\n    };\n  }\n};\n\nconst addComments = async text => {\n  await db.comments.add({\n    text: text\n  }).catch(err => {\n    window.alert(err);\n  });\n};","map":{"version":3,"sources":["/Users/nirob/Desktop/rfh-chat/simplechat/src/worker.js"],"names":["default","db","require","onmessage","e","data","op","ws","WebSocket","onopen","console","log","send","JSON","stringify","value","msg","parse","addComments","cmnt","then","postMessage","catch","err","text","comments","add","window","alert"],"mappings":"AAAA,MAAM;AAAEA,EAAAA,OAAO,EAAEC;AAAX,IAAkBC,OAAO,CAAC,YAAD,CAA/B;;AAEAC,SAAS,GAAGC,CAAC,IAAI;AACb,MAAIA,CAAC,CAACC,IAAF,CAAOC,EAAP,KAAc,KAAlB,EAAyB;AACrB,QAAIC,EAAE,GAAG,IAAIC,SAAJ,CAAc,qBAAd,CAAT;;AACAD,IAAAA,EAAE,CAACE,MAAH,GAAY,MAAM;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAJ,MAAAA,EAAE,CAACK,IAAH,CAAQC,IAAI,CAACC,SAAL,CAAeV,CAAC,CAACC,IAAF,CAAOU,KAAtB,CAAR;AACH,KAHD;;AAIAR,IAAAA,EAAE,CAACJ,SAAH,GAAea,GAAG,IAAI;AAClBN,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BK,GAAG,CAACX,IAA9B;AACA,UAAIA,IAAI,GAAGQ,IAAI,CAACI,KAAL,CAAWD,GAAG,CAACX,IAAf,CAAX;AACAa,MAAAA,WAAW,CAACb,IAAI,CAACc,IAAN,CAAX,CAAuBC,IAAvB,CAA4B,MAAK;AAC7BC,QAAAA,WAAW,CAACL,GAAG,CAACX,IAAL,CAAX;AACH,OAFD,EAEGiB,KAFH,CAEUC,GAFV;AAGH,KAND;AAOH;AACJ,CAfD;;AAiBA,MAAML,WAAW,GAAG,MAAOM,IAAP,IAAgB;AAChC,QAAMvB,EAAE,CAACwB,QAAH,CAAYC,GAAZ,CAAgB;AAClBF,IAAAA,IAAI,EAAEA;AADY,GAAhB,EAEHF,KAFG,CAEIC,GAAD,IAAQ;AACbI,IAAAA,MAAM,CAACC,KAAP,CAAaL,GAAb;AACH,GAJK,CAAN;AAKH,CAND","sourcesContent":["const { default: db } = require(\"./Dexie/db\");\n\nonmessage = e => {\n    if (e.data.op === 'add') {\n        let ws = new WebSocket(\"ws://localhost:3000\");\n        ws.onopen = () => {\n            console.log(\"open connection\");\n            ws.send(JSON.stringify(e.data.value));\n        };\n        ws.onmessage = msg => {\n            console.log(\"getMessage\", msg.data);\n            let data = JSON.parse(msg.data);\n            addComments(data.cmnt).then(()=> {\n                postMessage(msg.data);\n            }).catch((err))\n        };\n    }\n}\n\nconst addComments = async (text) => {\n    await db.comments.add({\n        text: text\n    }).catch((err)=> {\n        window.alert(err);\n    })\n}"]},"metadata":{},"sourceType":"module"}